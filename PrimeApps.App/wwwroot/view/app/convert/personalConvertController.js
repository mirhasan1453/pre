"use strict";angular.module("primeapps").controller("PersonalConvertController",["$rootScope","$scope","$location","$state","$filter","$q","ngToast","helper","PersonalConvertService","ModuleService","$cache",function(e,a,t,l,o,n,i,r,d,c,s){return a.id=t.search().id,a.module=o("filter")(e.modules,{name:"adaylar"},!0)[0],a.currentDayMin=r.getCurrentDateMin().toISOString(),a.currentDayMax=r.getCurrentDateMax().toISOString(),a.deleted=!1,a.module&&a.id?(a.accountModule=o("filter")(e.modules,{name:"calisanlar"},!0)[0],a.leadModulePrimaryField=o("filter")(a.module.fields,{primary:!0},!0)[0],a.loading=!0,c.getPicklists(a.module).then(function(e){a.picklistsModule=e,c.getRecord(a.module.name,a.id).then(function(e){a.lead=c.processRecordSingle(e.data,a.module,a.picklistsModule),c.formatRecordFieldValues(angular.copy(e.data),a.module,a.picklistsModule)})["finally"](function(){a.loading=!1})}),void(a.convert=function(){a.loading=!0;var e={};e.lead_id=a.lead.id,e.deleted=a.deleted,d.convert(e).then(function(e){a.converted=e.data,a.convertDisable=!0,s.remove("adaylar_adaylar"),s.remove("calisanlar_calisanlar"),s.remove("activities_activities"),i.create({content:o("translate")("Convert.Success",{type:a.module["label_"+language+"_singular"]}),className:"success"})})["catch"](function(e){409===e.status&&a.moduleForm[e.data.field].$setValidity("unique",!1)})["finally"](function(){a.loading=!1})})):(i.create({content:o("translate")("Common.NotFound"),className:"warning"}),void l.go("app.dashboard"))}]);