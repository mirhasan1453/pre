"use strict";angular.module("primeapps").controller("ImportHistoryController",["$rootScope","$scope","$cache","helper","ImportHistoryService",function(e,r,t,i,o){r.currentPage=1,r.importHistoryFilter={},r.find=function(){r.allImportsLoaded=!1,i.hasAdminRights()||(r.importHistoryFilter.userId=e.user.id);var t={limit:30,offset:30*(r.currentPage-1),module_id:r.importHistoryFilter.moduleId,user_id:r.importHistoryFilter.userId};o.find(t).then(function(e){e=e.data,r.pagingIcon="fa-chevron-right",angular.forEach(e,function(e){var r=decodeURIComponent(e.excel_url);e.file_name=r.slice(r.indexOf("--")+2),e.file_url=e.excel_url.slice(0,e.excel_url.indexOf("--"))}),r.imports=1===r.currentPage?e:r.imports.concat(e),(e.length<1||e.length<t.limit)&&(r.allImportsLoaded=!0),r.searching=!1})},r.loadMore=function(){r.allImportsLoaded||(r.pagingIcon="fa-spinner fa-spin",r.currentPage=r.currentPage+1,r.find())},r.cancel=function(){r.showFilter=!1,r.showFilterButton=!0,r.importHistoryFilter&&(r.currentPage=1,r.importHistoryFilter={},r.find())},r.find(),r.revert=function(e){o.revert(e.id).then(function(){r.currentPage=1,r.find();var i=e.module.name+"_"+e.module.name;t.remove(i)})}}]);