"use strict";angular.module("primeapps").controller("OfficeController",["$rootScope","$scope","$filter","ngToast","OfficeService","$localStorage","$window","$interval","officeHelper",function(e,o,n,i,t,c,r,a){o.hasAdminRight=n("filter")(e.profiles,{id:e.user.profile.id},!0)[0].has_admin_rights,o.officeConnectionOpening=!1,o.isConnected=!1,o.loading=!0,o.popupClosed=function(){t.activeDirectoryInfo().then(function(n){n.data?(e.user.azureDirectory=n.data,o.adInfo=n.data,o.isConnected=!0):o.officeConnectionOpening=!1})},o.officeConnection=function(){o.officeConnectionOpening=!0;var e=r.open("/ActiveDirectory/SignUp","popUpWindow","height=550,width=600,resizable=no,scrollbars=yes,menubar=no"),n=a(function(){e.closed!==!1&&(a.cancel(n),o.popupClosed())},200)}}]);