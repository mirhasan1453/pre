"use strict";angular.module("primeapps").controller("OrganizationController",["$rootScope","$scope","$translate","tmhDynamicLocale","$localStorage","ngToast","config","$window","$timeout","$filter","blockUI","FileUploader","AppService","OrganizationService","$cookies",function(e,n,t,o,a,r,i,c,l,u,p,s,g,m){function d(e){e||(n.companyUpdating=!0),m.editCompany(n.company).then(function(){e?f.clearQueue():(r.create({content:u("translate")("Setup.Organization.UpdateSuccess"),className:"success"}),n.companyUpdating=!1),g.getMyAccount(!0)})}n.company={},n.company.instanceID=e.workgroup.tenant_id,n.company.title=e.workgroup.title,n.company.currency=e.workgroup.currency,n.company.culture=e.workgroup.setting.culture,n.company.logo=e.workgroup.setting.logo,n.company.tenant_id=e.user.tenant_id,n.company.language=e.workgroup.setting.language,n.bounds={},n.bounds.left=0,n.bounds.right=0,n.bounds.top=0,n.bounds.bottom=0,n.user=e.user,n.editCompany=function(){n.companyForm.$valid&&d(!1)};var f=n.uploader=new s({url:"storage/upload_logo",queueLimit:1});f.onCompleteItem=function(e,t,o){200===o&&(n.company.logo=t,d(!0))},f.onWhenAddingFileFailed=function(e,n){switch(n.name){case"imageFilter":r.create({content:u("translate")("Setup.Settings.ImageError"),className:"warning"});break;case"sizeFilter":r.create({content:u("translate")("Setup.Organization.SizeError"),className:"warning"})}},f.onAfterAddingFile=function(e){var t=new FileReader;t.onload=function(e){n.$apply(function(){n.imagePreview=e.target.result})},t.readAsDataURL(e._file)},f.filters.push({name:"imageFilter",fn:function(e){var n="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return"|jpg|png|jpeg|bmp|".indexOf(n)>-1}}),f.filters.push({name:"sizeFilter",fn:function(e){return e.size<5e4}}),n.removeLogo=function(){n.company.logo=null,n.imagePreview=null,d(!0)}}]);